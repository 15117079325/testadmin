

{include file="pageheader.htm"}
{insert_scripts files="../js/transport.org.js,../js/region.js"}

<!-- 20180508 1413 V -->
<style type="text/css">
    
    .box {

        padding: 20px;
        min-height: 600px;
    }

    .box span {

        display: inline-block;
        width: 100px;
    }

    .score {

        float: left;
        margin: 0 20px;
    }


    font {

        display: inline-block;
        font-size: 16px;
        font-weight: 600;
        color: #666;
        margin-bottom: 10px;

    }
</style>

<div class="main-div box">

    <div class="score" style="border-right: 1px solid #ccc;">
        
        <font> 报单设置 </font><br>

        <span> 报单金额下限：</span>
        <input type="text" id="limit0" placeholder="100" value="{$list.precharge_min}">
        <br>
        <span> 报单金额上限：</span>
        <input type="text" id="limit1" placeholder="20000" value="{$list.precharge_max}">
        <br>
        <span> 新美积分 / 消费积分：</span>
        <input type="text" id="xps_cps" placeholder="1:1" value="{$list.precharge_propo}">
        <br>
        <span> 报单获得待用积分：</span>
        <input type="text" id="surplus" placeholder="9000" value="{$list.precharge_sur}" disabled="">
        <br>
        <span> 待用积分发放比例：</span>
        <input type="text" id="propo0" placeholder="2:2:2:3" value="{$list.surplus_propo}" disabled="">
        <br>
        <span> 购物券产出比例：</span>
        <input type="text" id="propo1" placeholder="1:1" value="{$list.coupon_propo}" disabled="">
        <br>
        <span> 消费积分释放规则 ：</span>
        <select name="precharge_rule" id="precharge_ru">
            <option value="10" {if $list.precharge_rule==10}selected{/if}>10天</option>
            <option value="15" {if $list.precharge_rule==15}selected{/if}>15天</option>
            <option value="20" {if $list.precharge_rule==20}selected{/if}>20天</option>
            <option value="25" {if $list.precharge_rule==25}selected{/if}>25天</option>
            <option value="30" {if $list.precharge_rule==30}selected{/if}>30天</option>
            <option value="35" {if $list.precharge_rule==35}selected{/if}>35天</option>
            <option value="40" {if $list.precharge_rule==40}selected{/if}>40天</option>
            <option value="45" {if $list.precharge_rule==45}selected{/if}>45天</option>
            <option value="50" {if $list.precharge_rule==50}selected{/if}>50天</option>
            <option value="55" {if $list.precharge_rule==55}selected{/if}>55天</option>
            <option value="60" {if $list.precharge_rule==60}selected{/if}>60天</option>
        </select>
        <br>
        <span></span>
        <input id="setting" type="button" class="button" name="" value="设置">

    </div>
    
    <!-- 20180524 1609 T 积分提现限制 -->
    <div class="score" style="border-right: 1px solid #ccc;">

        <font> T 积分提现设置 </font><br>

        <span> 提现时间：</span>
        <input type="text" id="ttime" placeholder="1-5-08-15" value="{$list.ttime}">
        * [1-5-08-15] 1-5 表示周一到周五可提现，08 表示早上，15 表示下午
        <br>
        <span> 每周提现累计额度：</span>
        <input type="text" id="addup" placeholder="10000" value="{$list.addup}">
        <br>
        <span> 是否可申请多次：</span>
        <input type="text" id="tmore" placeholder="1 or 0" value="{$list.tmore}"> * 0 不可， 1 可
        <br>

        <span></span>
        <input id="tscore" type="button" class="button" name="" value="设置">

    </div>

    <div class="score">

        <font> 相关消费积分设置 </font><br>

        <span> 1T积分对应消费积分数量：</span>
        <input type="text" id="tshop" placeholder="1000" value="{$list.tscore_consume}">
        <br>
        <span> 签到赠送消费积分：</span>
        <input type="text" id="sshop" placeholder="2" value="{$list.daily_sign_consume}">
        <br>
        <span> 单日购买最大金额 ：</span>
        <input type="text" id="buy_max_money" placeholder="2" value="{$list.daily_deal_buy_max_money}">
         <br>
        <span> 单日出售最大金额 ：</span>
        <input type="text" id="sell_max_money" placeholder="2" value="{$list.daily_deal_sell_max_money}">
        <br>
        <span> 交易大厅开放时间 ：</span>
        <input type="text" id="open_close_time" placeholder="08:00-22:00" value="{$list.deal_open_close_time}">
        <br>
        <span> 交易大厅手续费 ：</span>
        <input type="text" id="trade_cost" placeholder="10" value="{$list.xm_trade_cost}">
        <br>
        <span></span>

        <input id="shopp" type="button" class="button" name="" value="设置">

    </div>
</div>

{literal}
<script type="text/javascript">
    
    $("#setting").on("click", function(){

        var limit0 = $("#limit0").val();
        var limit1 = $("#limit1").val();
        var xps_cps = $("#xps_cps").val();
        var precharge_ru = $("#precharge_ru").val();


        if (!limit0 || !limit1 || !xps_cps) {

            alert('请设置完整');
            return;
        }

        if (limit0 >= limit1) {

            alert("下限金额需小于上限金额");
            return;
        }

        if (limit0 % 100 != 0 || limit1 % 100 != 0) {

            alert("上下限金额需是 100 的整数倍");
            return;
        }

        var xc_arr = new Array();
        xc_arr = xps_cps.split(':');

        if (10 % (parseInt(xc_arr[0]) + parseInt(xc_arr[1])) != 0) {

            alert("新美消费积分比例设置错误");
            return;
        }

        $.ajax({
            type:"POST",
            url:'shop_config.php',
            dataType: 'json',
            data:{act:'set_settings',limit0:limit0, limit1:limit1, xps_cps:xps_cps,precharge_ru:precharge_ru},
            success: function(data) {

                if (data.sus == 1) {

                    alert("操作成功");
                    location.reload();

                } else {

                    alert(data.msg);

                }
            }
        });

    });

    $("#tscore").on("click", function() {

        var ttime = $("#ttime").val();
        var addup = $("#addup").val();
        var tmore = $("#tmore").val();

        if (!ttime || !addup || !tmore) {

            alert("请填写完整的设置");
            return false;
        }

        var arr = new Array();

        arr = ttime.split("-");

        for (var i = 0; i < arr.length; i++) {
            
            arr[i] = parseInt(arr[i]);
        }

        if (arr[0] <= 0 || arr[1] <= 0 || arr[0] > 5 || arr[1] > 5 || arr[0] > arr[1]) {

            alert("周期设置错误");
            return false;
        }

        if (arr[2] < 0 || arr[3] < 0 || arr[2] > 24 || arr[3] > 24 || arr[2] > arr[3] || arr[2] == arr[3]) {

            alert("时间设置错误");
            return false;
        }

        $.ajax({
            type:"POST",
            url:'shop_config.php',
            dataType: 'json',
            data:{act:'tscore', ttime:ttime, addup:addup, tmore:tmore},
            success: function(data) {

                alert(data.msg);

                if (data.sus == 1) {

                    location.reload();

                }
            }
        });

    });

    $("#shopp").on("click", function() {

        var tshop = $("#tshop").val();
        var sshop = $("#sshop").val();
        var sell_max_money = $("#sell_max_money").val();
        var buy_max_money = $("#buy_max_money").val();
        var open_close_time = $("#open_close_time").val();
        var trade_cost = $("#trade_cost").val();


        if (!tshop || !tshop) {

            alert("请填写完整的设置");
            return false;
        }

        $.ajax({
            type:"POST",
            url:'shop_config.php',
            dataType: 'json',
            data:{act:'shopp', tshop:tshop, sshop:sshop,buy_max_money:buy_max_money,sell_max_mony:sell_max_money,open_close_time:open_close_time,trade_cost:trade_cost},
            success: function(data) {

                alert(data.msg);

                if (data.sus == 1) {

                    location.reload();

                }
            }
        });

    });
</script>
{/literal}

{include file="pagefooter.htm"}
