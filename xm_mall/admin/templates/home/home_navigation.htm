<!-- $Id: ads_list.htm 14216 2008-03-10 02:27:21Z testyang $ -->
{if $full_page}
{include file="pageheader.htm"}
{insert_scripts files="../js/utils.js,listtable.js"}

<form method="post" action="" name="listForm">
<!-- start ads list -->
<div class="list-div" id="listDiv">
{/if}

<table cellpadding="3" cellspacing="1">
  <tr>
    <th>编号</th>
    <th>导航栏名字</th>
    <th>跳转链接</th>
    <th>图片</th>
     <th>排序</th>
      <th>启用</th>
    <th>{$lang.handler}</th>
  </tr>
  {foreach from=$nav_list item=list}
     <tr>
    <td class="first-cell">
    <span>{$list.outer_id}</span>
    </td>
     <td class="first-cell">
    <span>{$list.outer_title|escape:html}</span>
    </td>
       <td class="first-cell">
    <span>{$list.outer_url|escape:html}</span>
    </td>
     <td align="center">
    <img src="{$list.outer_img}" style="width:100px;" />
    </td>
    <td align="right"><span onclick="update_name(this)">{$list.outer_sort|escape:html}</span><input type="text" name="update_name" value="{$list.outer_sort|escape:html}" style="display:none;" onblur="update_names(this,'outer_sort',{$list.outer_id})"/></td>
    <td align="center"><img src="images/{if $list.status}yes{else}no{/if}.gif" onclick="update_status(this,'status',{$list.outer_id})" data="{$list.status}"/></td>
      <td align="right">
      <a href="home_navigation.php?act=edit&id={$list.outer_id}" title="{$lang.edit}"><img src="images/icon_edit.gif" border="0" height="16" width="16" /></a>
      <a href="javascript:;" onclick="remove_goods(this,{$list.outer_id})" title="{$lang.remove}"><img src="images/icon_drop.gif" border="0" height="16" width="16" /></a>
    </td>
  </tr>
  {foreachelse}
    <tr><td class="no-records" colspan="10">{$lang.no_ads}</td></tr>
  {/foreach}
  <tr>
    <td align="right" nowrap="true" colspan="10">{include file="page.htm"}</td>
  </tr>
</table>

{if $full_page}
</div>
<!-- end ad_position list -->
</form>

<script type="text/javascript" language="JavaScript">
  function update_name(obj){
      $(obj).text('');
      $(obj).next().show();
  }
  function remove_goods(obj,id){
      if(confirm('确定要删除吗')){
         $.ajax({
                type:'post',
                url:'home_navigation.php?act=remove',
                data:{id:id},
                dataType:'json',
                success:function(data){  //请求成功回调函数
                    var status = data.status; //获取返回值
                    if(status == 1){  //判断状态码，200为成功
                        $(obj).parent().parent().remove();
                       alert('删除成功')
                    }else{
                        alert('请重新操作')
                    }
                },
            });
      }
  }
  function update_names(obj,key,id){
      var title = $(obj).val();
      if(title===''){
          alert('名字不能为空');
          return;
      }
      $.ajax({
                type:'post',
                url:'home_navigation.php?act=update_name',
                data:{key:key,id:id,title:title},
                dataType:'json',
                success:function(data){  //请求成功回调函数
                    var status = data.status; //获取返回值
                    if(status == 1){  //判断状态码，200为成功
                        $(obj).val(title);
                        $(obj).hide();
                        $(obj).prev().text(title);
                    }else{
                        alert('请重新操作')
                    }
                },
            });
  }
  function update_status(obj,key,id){
      var status = $(obj).attr('data');
        $.ajax({
                type:'post',
                url:'home_navigation.php?act=update_status',
                data:{key:key,id:id,status:status},
                dataType:'json',
                success:function(data){  //请求成功回调函数
                    var status = data.status; //获取返回值
                    if(status == 1){  //判断状态码，200为成功
                        $(obj).attr('data',status);
                        $(obj).attr('src','images/yes.gif');
                    }else{
                        $(obj).attr('data',status);
                       $(obj).attr('src','images/no.gif');
                    }
                },
            });
  }
  listTable.recordCount = {$record_count};
  listTable.pageCount = {$page_count};

  {foreach from=$filter item=item key=key}
  listTable.filter.{$key} = '{$item}';
  {/foreach}
  {literal}
  onload = function()
  {
    // 开始检查订单
    startCheckOrder();
  }
  {/literal}
</script>
{include file="pagefooter.htm"}
{/if}
