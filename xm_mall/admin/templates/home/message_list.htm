<!-- $Id: ads_list.htm 14216 2008-03-10 02:27:21Z testyang $ -->
{if $full_page}
{include file="pageheader.htm"}
{insert_scripts files="../js/utils.js,listtable.js"}

<form method="post" action="" name="listForm">
<!-- start ads list -->
<div class="list-div" id="listDiv">
{/if}

<table cellpadding="3" cellspacing="1">
  <tr>
    <th>编号</th>
    <th>标题</th>
    <th>内容</th>
    <th>推送</th>
    <th>时间</th>
    <th>{$lang.handler}</th>
  </tr>
  {foreach from=$nav_list item=list}
     <tr>
    <td class="first-cell">
    <span>{$list.am_id}</span>
    </td>
       <td class="first-cell">
    <span>{$list.am_title}</span>
    </td>
       <td class="first-cell">
    <span>{$list.am_content}</span>
    </td>
       <td class="first-cell">
         <span>{if $list.am_status==0}<button onclick="update_status(this,{$list.am_id},{$list.am_status})">未推送</button>{elseif $list.am_status==1}推送中{else}已推送{/if}</span>
    </td>
       <td class="first-cell">
    <span>{$list.am_gmt_create}</span>
    </td>
      <td align="right">
        {if $list.am_status==0}
        <a href="app_message.php?act=edit&am_id={$list.am_id}" title="{$lang.edit}"><img src="images/icon_edit.gif" width="16" height="16" border="0" /></a>
        {/if}
      <a href="javascript:;" onclick="remove_goods(this,{$list.am_id})" title="{$lang.remove}"><img src="images/icon_drop.gif" border="0" height="16" width="16" /></a>
    </td>
  </tr>
  {foreachelse}
    <tr><td class="no-records" colspan="10">{$lang.no_ads}</td></tr>
  {/foreach}
  <tr>
    <td align="right" nowrap="true" colspan="10">{include file="page.htm"}</td>
  </tr>
</table>

{if $full_page}
</div>
<!-- end ad_position list -->
</form>

<script type="text/javascript" language="JavaScript">


  function remove_goods(obj,id){
      if(confirm('确定要删除吗')){
         $.ajax({
                type:'post',
                url:'app_message.php?act=remove',
                data:{id:id},
                dataType:'json',
                success:function(data){  //请求成功回调函数
                    var status = data.status; //获取返回值
                    if(status == 1){  //判断状态码，200为成功
                        $(obj).parent().parent().remove();
                       alert('删除成功')
                    }else{
                        alert('请重新操作')
                    }
                },
            });
      }
  }

  function update_status(obj,id,status){
      if(confirm('确定要推送吗')){
         $.ajax({
                type:'post',
                url:'app_message.php?act=update_name',
                data:{id:id,status:status},
                dataType:'json',
                success:function(data){  //请求成功回调函数
                    var status = data.status; //获取返回值
                    if(status == 1){  //判断状态码，200为成功
                        $(obj).parent().text('已推送');
                    }else{
                        alert('请重新操作')
                    }
                },
            });
      }
  }

  listTable.recordCount = {$record_count};
  listTable.pageCount = {$page_count};

  {foreach from=$filter item=item key=key}
  listTable.filter.{$key} = '{$item}';
  {/foreach}
  {literal}
  onload = function()
  {
    // 开始检查订单
    startCheckOrder();
  }
  {/literal}
</script>
{include file="pagefooter.htm"}
{/if}
